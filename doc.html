<!DOCTYPE html>
<html>
<head>
    <script src="/typson/lib/require.js"></script>
    <meta charset="utf-8">
    <link rel="stylesheet" href="/docson/css/docson.css">
    <script src="/docson/lib/jquery.js"></script>
    <script src="/docson/lib/handlebars.js"></script>
    <script src="/docson/lib/highlight.js"></script>
    <script src="/docson/lib/traverse.js"></script>
    <script src="/docson/docson.js"></script> 
    <title>Typson playground</title>
    <style>
        body { font-family: helvetica }
    </style>
</head>
<body>
    <div id="doc">loading...</div>
    <script>
        var marked;
        docson.templateBaseUrl="/docson/templates";
        require.config({                        
                baseUrl: "/typson"                
        });
        require(["../docson/lib/jsonpointer", "../docson/lib/marked"], function(jsonpointer, markedjs) {                   
            marked = markedjs;
            require(["typson-schema"], function(schema) {
                function receiveMessage(event)
                {
                    schema.definitions(event.data).done(function(defs) {
                        var firstKey = Object.keys(defs)[0];
                        $.extend(defs, defs[firstKey]);
                        delete defs[firstKey]                        
                        var doc = $("#doc");
                        docson.doc(doc, defs);
                        doc.find(".signature-type-expandable").toggleClass("signature-type-expanded");
                        doc.find(".box-container").show();                      
                    });                 
                }
                window.addEventListener("message", receiveMessage, false);
            });
        });
    </script>
</body>
</html>
